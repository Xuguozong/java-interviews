> nginx本地缓存 + redis分布式缓存 + tomcat堆缓存的多级缓存架构



#### 时效性的影响

- 时效性要求高的
  - 商品价格/库存等时效性要求高的数据，而且种类较少，直接采取数据库和redis缓存双写的方案
- 时效性要求不高的
  - 商品基本信息等时效性不高的数据，而且种类繁多，来自多种不同的系统，采取MQ异步通知的方式，写一个数据生产服务，监听MQ消息，然后异步拉取服务的数据，更新tomcat jvm缓存+redis缓存



#### 多级缓存架构中每一层的意义

- Nginx
  - ginx+lua脚本做页面动态生成的工作，每次请求过来，优先从nginx本地缓存中提取各种数据，结合页面模板，生成需要的页面，如果nginx本地缓存过期了，那么就从nginx到redis中去拉取数据，更新到nginx本地
- 分布式 Redis 缓存
  - 抗高并发
- 应用堆内存缓存
  - 抗住redis没有cache住的最后那少量的部分缓存

